@page "/counter"
@using BlazorWA.Models
@using Newtonsoft.Json
@using System.Text

<h1>Create order</h1>

<EditForm Model="@_order" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <label>
        Starting point:
        <InputText id="startingPoint" @bind-Value="_order.StartingPoint" />
    </label>
    <label>
        Destination point:
        <InputText id="destinationPoint" @bind-Value="_order.DestinationPoint" />
    </label>
    <label>
        Type of car:
        <InputText id="typeOfCar" @bind-Value="_order.TypeOfCar" />
    </label>
    <label>
        Amount of seats:
        <InputNumber id="amountOfSeats" @bind-Value="_order.AmountOfSeats" />
    </label>
    @* <label> *@
    @*     Amount of seats: *@
    @*     <InputSelect @bind-Value="_order.AmountOfSeats"> *@
    @*         <option default value="1">1</option> *@
    @*         <option value="2">2</option> *@
    @*         <option value="3">3</option> *@
    @*         <option value="4">4</option> *@
    @*     </InputSelect> *@
    @* </label> *@

    <button type="submit">Submit</button>
</EditForm>

@code {
    private readonly HttpClient _httpClient = new HttpClient();
    private Order _order = new Order {CustomerId = 1};

    private async void HandleValidSubmit()
    {
        // serializez with first capital hour
        string serializedOrder = System.Text.Json.JsonSerializer.Serialize(_order);
        StringContent content = new StringContent(
            serializedOrder, Encoding.UTF8, "application/json");
        Console.WriteLine(serializedOrder);
        HttpResponseMessage responseMessage = await _httpClient.PostAsync("http://localhost:8080/orders", content);
    }
}